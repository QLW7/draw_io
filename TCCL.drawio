<mxfile host="app.diagrams.net" agent="Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/143.0.0.0 Safari/537.36" version="29.2.9">
  <diagram name="第 1 页" id="V4PZYKdTSyOcaOsxyUSm">
    <mxGraphModel dx="4040" dy="2463" grid="0" gridSize="10" guides="1" tooltips="1" connect="1" arrows="1" fold="1" page="0" pageScale="1" pageWidth="827" pageHeight="1169" background="none" math="0" shadow="0">
      <root>
        <mxCell id="0" />
        <mxCell id="1" parent="0" />
        <mxCell id="GRuPrAwGHJj99uNFda9p-1" parent="1" style="swimlane;fontStyle=1;align=center;verticalAlign=top;childLayout=stackLayout;horizontal=1;startSize=56.727272727272734;horizontalStack=0;resizeParent=1;resizeParentMax=0;resizeLast=0;collapsible=0;marginBottom=0;fontSize=14;" value="&lt;&lt;c10d::Backend&gt;&gt;&#xa;Backend" vertex="1">
          <mxGeometry height="216.72727272727275" width="198" x="1347" y="198" as="geometry" />
        </mxCell>
        <mxCell id="GRuPrAwGHJj99uNFda9p-2" parent="GRuPrAwGHJj99uNFda9p-1" style="text;strokeColor=none;fillColor=none;align=left;verticalAlign=top;spacingLeft=4;spacingRight=4;overflow=hidden;rotatable=0;points=[[0,0.5],[1,0.5]];portConstraint=eastwest;fontSize=14;" value="#rank_ : int" vertex="1">
          <mxGeometry height="38" width="198" y="56.727272727272734" as="geometry" />
        </mxCell>
        <mxCell id="GRuPrAwGHJj99uNFda9p-3" parent="GRuPrAwGHJj99uNFda9p-1" style="text;strokeColor=none;fillColor=none;align=left;verticalAlign=top;spacingLeft=4;spacingRight=4;overflow=hidden;rotatable=0;points=[[0,0.5],[1,0.5]];portConstraint=eastwest;fontSize=14;" value="#size_ : int" vertex="1">
          <mxGeometry height="38" width="198" y="94.72727272727273" as="geometry" />
        </mxCell>
        <mxCell id="GRuPrAwGHJj99uNFda9p-4" parent="GRuPrAwGHJj99uNFda9p-1" style="line;strokeWidth=1;fillColor=none;align=left;verticalAlign=middle;spacingTop=-1;spacingLeft=3;spacingRight=3;rotatable=0;labelPosition=right;points=[];portConstraint=eastwest;strokeColor=inherit;fontSize=14;" vertex="1">
          <mxGeometry height="8" width="198" y="132.72727272727275" as="geometry" />
        </mxCell>
        <mxCell id="GRuPrAwGHJj99uNFda9p-5" parent="GRuPrAwGHJj99uNFda9p-1" style="text;strokeColor=none;fillColor=none;align=left;verticalAlign=top;spacingLeft=4;spacingRight=4;overflow=hidden;rotatable=0;points=[[0,0.5],[1,0.5]];portConstraint=eastwest;fontSize=14;" value="+getRank() : int" vertex="1">
          <mxGeometry height="38" width="198" y="140.72727272727275" as="geometry" />
        </mxCell>
        <mxCell id="GRuPrAwGHJj99uNFda9p-6" parent="GRuPrAwGHJj99uNFda9p-1" style="text;strokeColor=none;fillColor=none;align=left;verticalAlign=top;spacingLeft=4;spacingRight=4;overflow=hidden;rotatable=0;points=[[0,0.5],[1,0.5]];portConstraint=eastwest;fontSize=14;" value="+getSize() : int" vertex="1">
          <mxGeometry height="38" width="198" y="178.72727272727275" as="geometry" />
        </mxCell>
        <mxCell id="GRuPrAwGHJj99uNFda9p-7" parent="1" style="swimlane;fontStyle=1;align=center;verticalAlign=top;childLayout=stackLayout;horizontal=1;startSize=62.25;horizontalStack=0;resizeParent=1;resizeParentMax=0;resizeLast=0;collapsible=0;marginBottom=0;fontSize=14;" value="&lt;&lt;c10d::Work&gt;&gt;&#xa;Work" vertex="1">
          <mxGeometry height="154.25" width="182" x="2142" y="701" as="geometry" />
        </mxCell>
        <mxCell id="GRuPrAwGHJj99uNFda9p-8" parent="GRuPrAwGHJj99uNFda9p-7" style="line;strokeWidth=1;fillColor=none;align=left;verticalAlign=middle;spacingTop=-1;spacingLeft=3;spacingRight=3;rotatable=0;labelPosition=right;points=[];portConstraint=eastwest;strokeColor=inherit;fontSize=14;" vertex="1">
          <mxGeometry height="8" width="182" y="62.25" as="geometry" />
        </mxCell>
        <mxCell id="GRuPrAwGHJj99uNFda9p-9" parent="GRuPrAwGHJj99uNFda9p-7" style="text;strokeColor=none;fillColor=none;align=left;verticalAlign=top;spacingLeft=4;spacingRight=4;overflow=hidden;rotatable=0;points=[[0,0.5],[1,0.5]];portConstraint=eastwest;fontSize=14;" value="+wait()" vertex="1">
          <mxGeometry height="42" width="182" y="70.25" as="geometry" />
        </mxCell>
        <mxCell id="GRuPrAwGHJj99uNFda9p-10" parent="GRuPrAwGHJj99uNFda9p-7" style="text;strokeColor=none;fillColor=none;align=left;verticalAlign=top;spacingLeft=4;spacingRight=4;overflow=hidden;rotatable=0;points=[[0,0.5],[1,0.5]];portConstraint=eastwest;fontSize=14;" value="+isCompleted()" vertex="1">
          <mxGeometry height="42" width="182" y="112.25" as="geometry" />
        </mxCell>
        <mxCell id="GRuPrAwGHJj99uNFda9p-11" parent="1" style="swimlane;fontStyle=1;align=center;verticalAlign=top;childLayout=stackLayout;horizontal=1;startSize=57;horizontalStack=0;resizeParent=1;resizeParentMax=0;resizeLast=0;collapsible=0;marginBottom=0;fontSize=14;" value="&lt;&lt;c10d::Store&gt;&gt;&#xa;Store" vertex="1">
          <mxGeometry height="179" width="187" x="789" y="1255" as="geometry" />
        </mxCell>
        <mxCell id="GRuPrAwGHJj99uNFda9p-12" parent="GRuPrAwGHJj99uNFda9p-11" style="line;strokeWidth=1;fillColor=none;align=left;verticalAlign=middle;spacingTop=-1;spacingLeft=3;spacingRight=3;rotatable=0;labelPosition=right;points=[];portConstraint=eastwest;strokeColor=inherit;fontSize=14;" vertex="1">
          <mxGeometry height="8" width="187" y="57" as="geometry" />
        </mxCell>
        <mxCell id="GRuPrAwGHJj99uNFda9p-13" parent="GRuPrAwGHJj99uNFda9p-11" style="text;strokeColor=none;fillColor=none;align=left;verticalAlign=top;spacingLeft=4;spacingRight=4;overflow=hidden;rotatable=0;points=[[0,0.5],[1,0.5]];portConstraint=eastwest;fontSize=14;" value="+set(key, value)" vertex="1">
          <mxGeometry height="38" width="187" y="65" as="geometry" />
        </mxCell>
        <mxCell id="GRuPrAwGHJj99uNFda9p-14" parent="GRuPrAwGHJj99uNFda9p-11" style="text;strokeColor=none;fillColor=none;align=left;verticalAlign=top;spacingLeft=4;spacingRight=4;overflow=hidden;rotatable=0;points=[[0,0.5],[1,0.5]];portConstraint=eastwest;fontSize=14;" value="+get(key)" vertex="1">
          <mxGeometry height="38" width="187" y="103" as="geometry" />
        </mxCell>
        <mxCell id="GRuPrAwGHJj99uNFda9p-15" parent="GRuPrAwGHJj99uNFda9p-11" style="text;strokeColor=none;fillColor=none;align=left;verticalAlign=top;spacingLeft=4;spacingRight=4;overflow=hidden;rotatable=0;points=[[0,0.5],[1,0.5]];portConstraint=eastwest;fontSize=14;" value="+wait(keys)" vertex="1">
          <mxGeometry height="38" width="187" y="141" as="geometry" />
        </mxCell>
        <mxCell id="GRuPrAwGHJj99uNFda9p-16" parent="1" style="swimlane;fontStyle=1;align=center;verticalAlign=top;childLayout=stackLayout;horizontal=1;startSize=26.90909090909091;horizontalStack=0;resizeParent=1;resizeParentMax=0;resizeLast=0;collapsible=0;marginBottom=0;fontSize=14;" value="ProcessGroupCNCL" vertex="1">
          <mxGeometry height="601.9090909090909" width="539" x="783" y="488" as="geometry" />
        </mxCell>
        <mxCell id="GRuPrAwGHJj99uNFda9p-17" parent="GRuPrAwGHJj99uNFda9p-16" style="text;strokeColor=none;fillColor=none;align=left;verticalAlign=top;spacingLeft=4;spacingRight=4;overflow=hidden;rotatable=0;points=[[0,0.5],[1,0.5]];portConstraint=eastwest;fontSize=14;" value="-store_ : c10d::Store" vertex="1">
          <mxGeometry height="27" width="539" y="26.90909090909091" as="geometry" />
        </mxCell>
        <mxCell id="GRuPrAwGHJj99uNFda9p-18" parent="GRuPrAwGHJj99uNFda9p-16" style="text;strokeColor=none;fillColor=none;align=left;verticalAlign=top;spacingLeft=4;spacingRight=4;overflow=hidden;rotatable=0;points=[[0,0.5],[1,0.5]];portConstraint=eastwest;fontSize=14;" value="-options_ : Options" vertex="1">
          <mxGeometry height="27" width="539" y="53.90909090909091" as="geometry" />
        </mxCell>
        <mxCell id="GRuPrAwGHJj99uNFda9p-19" parent="GRuPrAwGHJj99uNFda9p-16" style="text;strokeColor=none;fillColor=none;align=left;verticalAlign=top;spacingLeft=4;spacingRight=4;overflow=hidden;rotatable=0;points=[[0,0.5],[1,0.5]];portConstraint=eastwest;fontSize=14;" value="-cncl_comm_counter_ : uint64_t" vertex="1">
          <mxGeometry height="27" width="539" y="80.9090909090909" as="geometry" />
        </mxCell>
        <mxCell id="GRuPrAwGHJj99uNFda9p-20" parent="GRuPrAwGHJj99uNFda9p-16" style="text;strokeColor=none;fillColor=none;align=left;verticalAlign=top;spacingLeft=4;spacingRight=4;overflow=hidden;rotatable=0;points=[[0,0.5],[1,0.5]];portConstraint=eastwest;fontSize=14;" value="-dev_cncl_comm_map_ : map&amp;gt;" vertex="1">
          <mxGeometry height="27" width="539" y="107.9090909090909" as="geometry" />
        </mxCell>
        <mxCell id="GRuPrAwGHJj99uNFda9p-21" parent="GRuPrAwGHJj99uNFda9p-16" style="text;strokeColor=none;fillColor=none;align=left;verticalAlign=top;spacingLeft=4;spacingRight=4;overflow=hidden;rotatable=0;points=[[0,0.5],[1,0.5]];portConstraint=eastwest;fontSize=14;" value="-cncl_streams_ : map&amp;gt;" vertex="1">
          <mxGeometry height="27" width="539" y="134.9090909090909" as="geometry" />
        </mxCell>
        <mxCell id="GRuPrAwGHJj99uNFda9p-22" parent="GRuPrAwGHJj99uNFda9p-16" style="text;strokeColor=none;fillColor=none;align=left;verticalAlign=top;spacingLeft=4;spacingRight=4;overflow=hidden;rotatable=0;points=[[0,0.5],[1,0.5]];portConstraint=eastwest;fontSize=14;" value="-cncl_events_ : map&amp;gt;" vertex="1">
          <mxGeometry height="27" width="539" y="161.9090909090909" as="geometry" />
        </mxCell>
        <mxCell id="GRuPrAwGHJj99uNFda9p-23" parent="GRuPrAwGHJj99uNFda9p-16" style="text;strokeColor=none;fillColor=none;align=left;verticalAlign=top;spacingLeft=4;spacingRight=4;overflow=hidden;rotatable=0;points=[[0,0.5],[1,0.5]];portConstraint=eastwest;fontSize=14;" value="-mutex_ : std::mutex" vertex="1">
          <mxGeometry height="27" width="539" y="188.9090909090909" as="geometry" />
        </mxCell>
        <mxCell id="GRuPrAwGHJj99uNFda9p-24" parent="GRuPrAwGHJj99uNFda9p-16" style="text;strokeColor=none;fillColor=none;align=left;verticalAlign=top;spacingLeft=4;spacingRight=4;overflow=hidden;rotatable=0;points=[[0,0.5],[1,0.5]];portConstraint=eastwest;fontSize=14;" value="-cncl_comm_watchdog_thread_ : std::thread" vertex="1">
          <mxGeometry height="27" width="539" y="215.9090909090909" as="geometry" />
        </mxCell>
        <mxCell id="GRuPrAwGHJj99uNFda9p-25" parent="GRuPrAwGHJj99uNFda9p-16" style="line;strokeWidth=1;fillColor=none;align=left;verticalAlign=middle;spacingTop=-1;spacingLeft=3;spacingRight=3;rotatable=0;labelPosition=right;points=[];portConstraint=eastwest;strokeColor=inherit;fontSize=14;" vertex="1">
          <mxGeometry height="8" width="539" y="242.9090909090909" as="geometry" />
        </mxCell>
        <mxCell id="GRuPrAwGHJj99uNFda9p-26" parent="GRuPrAwGHJj99uNFda9p-16" style="text;strokeColor=none;fillColor=none;align=left;verticalAlign=top;spacingLeft=4;spacingRight=4;overflow=hidden;rotatable=0;points=[[0,0.5],[1,0.5]];portConstraint=eastwest;fontSize=14;" value="+ProcessGroupCNCL(store, rank, size, options)" vertex="1">
          <mxGeometry height="27" width="539" y="250.9090909090909" as="geometry" />
        </mxCell>
        <mxCell id="GRuPrAwGHJj99uNFda9p-27" parent="GRuPrAwGHJj99uNFda9p-16" style="text;strokeColor=none;fillColor=none;align=left;verticalAlign=top;spacingLeft=4;spacingRight=4;overflow=hidden;rotatable=0;points=[[0,0.5],[1,0.5]];portConstraint=eastwest;fontSize=14;" value="+~ProcessGroupCNCL()" vertex="1">
          <mxGeometry height="27" width="539" y="277.9090909090909" as="geometry" />
        </mxCell>
        <mxCell id="GRuPrAwGHJj99uNFda9p-28" parent="GRuPrAwGHJj99uNFda9p-16" style="text;strokeColor=none;fillColor=none;align=left;verticalAlign=top;spacingLeft=4;spacingRight=4;overflow=hidden;rotatable=0;points=[[0,0.5],[1,0.5]];portConstraint=eastwest;fontSize=14;" value="+send(tensors, dst_rank, tag) : WorkPtr" vertex="1">
          <mxGeometry height="27" width="539" y="304.9090909090909" as="geometry" />
        </mxCell>
        <mxCell id="GRuPrAwGHJj99uNFda9p-29" parent="GRuPrAwGHJj99uNFda9p-16" style="text;strokeColor=none;fillColor=none;align=left;verticalAlign=top;spacingLeft=4;spacingRight=4;overflow=hidden;rotatable=0;points=[[0,0.5],[1,0.5]];portConstraint=eastwest;fontSize=14;" value="+recv(tensors, src_rank, tag) : WorkPtr" vertex="1">
          <mxGeometry height="27" width="539" y="331.9090909090909" as="geometry" />
        </mxCell>
        <mxCell id="GRuPrAwGHJj99uNFda9p-30" parent="GRuPrAwGHJj99uNFda9p-16" style="text;strokeColor=none;fillColor=none;align=left;verticalAlign=top;spacingLeft=4;spacingRight=4;overflow=hidden;rotatable=0;points=[[0,0.5],[1,0.5]];portConstraint=eastwest;fontSize=14;" value="+allreduce(tensors, opts) : WorkPtr" vertex="1">
          <mxGeometry height="27" width="539" y="358.9090909090909" as="geometry" />
        </mxCell>
        <mxCell id="GRuPrAwGHJj99uNFda9p-31" parent="GRuPrAwGHJj99uNFda9p-16" style="text;strokeColor=none;fillColor=none;align=left;verticalAlign=top;spacingLeft=4;spacingRight=4;overflow=hidden;rotatable=0;points=[[0,0.5],[1,0.5]];portConstraint=eastwest;fontSize=14;" value="+broadcast(tensors, opts) : WorkPtr" vertex="1">
          <mxGeometry height="27" width="539" y="385.9090909090909" as="geometry" />
        </mxCell>
        <mxCell id="GRuPrAwGHJj99uNFda9p-32" parent="GRuPrAwGHJj99uNFda9p-16" style="text;strokeColor=none;fillColor=none;align=left;verticalAlign=top;spacingLeft=4;spacingRight=4;overflow=hidden;rotatable=0;points=[[0,0.5],[1,0.5]];portConstraint=eastwest;fontSize=14;" value="+barrier(opts) : WorkPtr" vertex="1">
          <mxGeometry height="27" width="539" y="412.9090909090909" as="geometry" />
        </mxCell>
        <mxCell id="GRuPrAwGHJj99uNFda9p-33" parent="GRuPrAwGHJj99uNFda9p-16" style="text;strokeColor=none;fillColor=none;align=left;verticalAlign=top;spacingLeft=4;spacingRight=4;overflow=hidden;rotatable=0;points=[[0,0.5],[1,0.5]];portConstraint=eastwest;fontSize=14;" value="-getCNCLComm(key, devices, op_type, p2p_rank, ...) : vector" vertex="1">
          <mxGeometry height="27" width="539" y="439.9090909090909" as="geometry" />
        </mxCell>
        <mxCell id="GRuPrAwGHJj99uNFda9p-34" parent="GRuPrAwGHJj99uNFda9p-16" style="text;strokeColor=none;fillColor=none;align=left;verticalAlign=top;spacingLeft=4;spacingRight=4;overflow=hidden;rotatable=0;points=[[0,0.5],[1,0.5]];portConstraint=eastwest;fontSize=14;" value="-pointToPoint(tensors, fn, peer, op_type, ...) : WorkPtr" vertex="1">
          <mxGeometry height="27" width="539" y="466.9090909090909" as="geometry" />
        </mxCell>
        <mxCell id="GRuPrAwGHJj99uNFda9p-35" parent="GRuPrAwGHJj99uNFda9p-16" style="text;strokeColor=none;fillColor=none;align=left;verticalAlign=top;spacingLeft=4;spacingRight=4;overflow=hidden;rotatable=0;points=[[0,0.5],[1,0.5]];portConstraint=eastwest;fontSize=14;" value="-collective(inputs, outputs, fn, op_type, ...) : WorkPtr" vertex="1">
          <mxGeometry height="27" width="539" y="493.9090909090909" as="geometry" />
        </mxCell>
        <mxCell id="GRuPrAwGHJj99uNFda9p-36" parent="GRuPrAwGHJj99uNFda9p-16" style="text;strokeColor=none;fillColor=none;align=left;verticalAlign=top;spacingLeft=4;spacingRight=4;overflow=hidden;rotatable=0;points=[[0,0.5],[1,0.5]];portConstraint=eastwest;fontSize=14;" value="-initWork(devices, rank, op_type, ...) : WorkCNCLPtr" vertex="1">
          <mxGeometry height="27" width="539" y="520.9090909090909" as="geometry" />
        </mxCell>
        <mxCell id="GRuPrAwGHJj99uNFda9p-37" parent="GRuPrAwGHJj99uNFda9p-16" style="text;strokeColor=none;fillColor=none;align=left;verticalAlign=top;spacingLeft=4;spacingRight=4;overflow=hidden;rotatable=0;points=[[0,0.5],[1,0.5]];portConstraint=eastwest;fontSize=14;" value="-broadcastCNCLCliqueID(cncl_id, is_p2p, ...) : void" vertex="1">
          <mxGeometry height="27" width="539" y="547.9090909090909" as="geometry" />
        </mxCell>
        <mxCell id="GRuPrAwGHJj99uNFda9p-38" parent="GRuPrAwGHJj99uNFda9p-16" style="text;strokeColor=none;fillColor=none;align=left;verticalAlign=top;spacingLeft=4;spacingRight=4;overflow=hidden;rotatable=0;points=[[0,0.5],[1,0.5]];portConstraint=eastwest;fontSize=14;" value="-cnclCommWatchdogInternal()" vertex="1">
          <mxGeometry height="27" width="539" y="574.9090909090909" as="geometry" />
        </mxCell>
        <mxCell id="GRuPrAwGHJj99uNFda9p-39" parent="1" style="swimlane;fontStyle=1;align=center;verticalAlign=top;childLayout=stackLayout;horizontal=1;startSize=28.923076923076923;horizontalStack=0;resizeParent=1;resizeParentMax=0;resizeLast=0;collapsible=0;marginBottom=0;fontSize=14;" value="WorkCNCL" vertex="1">
          <mxGeometry height="384.9230769230769" width="286" x="1898" y="1162" as="geometry" />
        </mxCell>
        <mxCell id="GRuPrAwGHJj99uNFda9p-40" parent="GRuPrAwGHJj99uNFda9p-39" style="text;strokeColor=none;fillColor=none;align=left;verticalAlign=top;spacingLeft=4;spacingRight=4;overflow=hidden;rotatable=0;points=[[0,0.5],[1,0.5]];portConstraint=eastwest;fontSize=14;" value="-devices_ : vector" vertex="1">
          <mxGeometry height="29" width="286" y="28.923076923076923" as="geometry" />
        </mxCell>
        <mxCell id="GRuPrAwGHJj99uNFda9p-41" parent="GRuPrAwGHJj99uNFda9p-39" style="text;strokeColor=none;fillColor=none;align=left;verticalAlign=top;spacingLeft=4;spacingRight=4;overflow=hidden;rotatable=0;points=[[0,0.5],[1,0.5]];portConstraint=eastwest;fontSize=14;" value="-cncl_comms_ : vector" vertex="1">
          <mxGeometry height="29" width="286" y="57.92307692307692" as="geometry" />
        </mxCell>
        <mxCell id="GRuPrAwGHJj99uNFda9p-43" parent="GRuPrAwGHJj99uNFda9p-39" style="text;strokeColor=none;fillColor=none;align=left;verticalAlign=top;spacingLeft=4;spacingRight=4;overflow=hidden;rotatable=0;points=[[0,0.5],[1,0.5]];portConstraint=eastwest;fontSize=14;" value="-cncl_end_events_ : vector" vertex="1">
          <mxGeometry height="29" width="286" y="86.92307692307692" as="geometry" />
        </mxCell>
        <mxCell id="GRuPrAwGHJj99uNFda9p-42" parent="GRuPrAwGHJj99uNFda9p-39" style="text;strokeColor=none;fillColor=none;align=left;verticalAlign=top;spacingLeft=4;spacingRight=4;overflow=hidden;rotatable=0;points=[[0,0.5],[1,0.5]];portConstraint=eastwest;fontSize=14;" value="-cncl_start_events_ : vector" vertex="1">
          <mxGeometry height="29" width="286" y="115.92307692307692" as="geometry" />
        </mxCell>
        <mxCell id="GRuPrAwGHJj99uNFda9p-44" parent="GRuPrAwGHJj99uNFda9p-39" style="text;strokeColor=none;fillColor=none;align=left;verticalAlign=top;spacingLeft=4;spacingRight=4;overflow=hidden;rotatable=0;points=[[0,0.5],[1,0.5]];portConstraint=eastwest;fontSize=14;" value="-outputs_ : vector" vertex="1">
          <mxGeometry height="29" width="286" y="144.9230769230769" as="geometry" />
        </mxCell>
        <mxCell id="GRuPrAwGHJj99uNFda9p-45" parent="GRuPrAwGHJj99uNFda9p-39" style="text;strokeColor=none;fillColor=none;align=left;verticalAlign=top;spacingLeft=4;spacingRight=4;overflow=hidden;rotatable=0;points=[[0,0.5],[1,0.5]];portConstraint=eastwest;fontSize=14;" value="-future_ : at::ivalue::Future" vertex="1">
          <mxGeometry height="29" width="286" y="173.9230769230769" as="geometry" />
        </mxCell>
        <mxCell id="GRuPrAwGHJj99uNFda9p-46" parent="GRuPrAwGHJj99uNFda9p-39" style="text;strokeColor=none;fillColor=none;align=left;verticalAlign=top;spacingLeft=4;spacingRight=4;overflow=hidden;rotatable=0;points=[[0,0.5],[1,0.5]];portConstraint=eastwest;fontSize=14;" value="-blocking_wait_ : bool" vertex="1">
          <mxGeometry height="29" width="286" y="202.9230769230769" as="geometry" />
        </mxCell>
        <mxCell id="GRuPrAwGHJj99uNFda9p-47" parent="GRuPrAwGHJj99uNFda9p-39" style="line;strokeWidth=1;fillColor=none;align=left;verticalAlign=middle;spacingTop=-1;spacingLeft=3;spacingRight=3;rotatable=0;labelPosition=right;points=[];portConstraint=eastwest;strokeColor=inherit;fontSize=14;" vertex="1">
          <mxGeometry height="8" width="286" y="231.9230769230769" as="geometry" />
        </mxCell>
        <mxCell id="GRuPrAwGHJj99uNFda9p-48" parent="GRuPrAwGHJj99uNFda9p-39" style="text;strokeColor=none;fillColor=none;align=left;verticalAlign=top;spacingLeft=4;spacingRight=4;overflow=hidden;rotatable=0;points=[[0,0.5],[1,0.5]];portConstraint=eastwest;fontSize=14;" value="+wait(timeout) : bool" vertex="1">
          <mxGeometry height="29" width="286" y="239.9230769230769" as="geometry" />
        </mxCell>
        <mxCell id="GRuPrAwGHJj99uNFda9p-49" parent="GRuPrAwGHJj99uNFda9p-39" style="text;strokeColor=none;fillColor=none;align=left;verticalAlign=top;spacingLeft=4;spacingRight=4;overflow=hidden;rotatable=0;points=[[0,0.5],[1,0.5]];portConstraint=eastwest;fontSize=14;" value="+synchronize() : void" vertex="1">
          <mxGeometry height="29" width="286" y="268.9230769230769" as="geometry" />
        </mxCell>
        <mxCell id="GRuPrAwGHJj99uNFda9p-50" parent="GRuPrAwGHJj99uNFda9p-39" style="text;strokeColor=none;fillColor=none;align=left;verticalAlign=top;spacingLeft=4;spacingRight=4;overflow=hidden;rotatable=0;points=[[0,0.5],[1,0.5]];portConstraint=eastwest;fontSize=14;" value="+isCompleted() : bool" vertex="1">
          <mxGeometry height="29" width="286" y="297.9230769230769" as="geometry" />
        </mxCell>
        <mxCell id="GRuPrAwGHJj99uNFda9p-51" parent="GRuPrAwGHJj99uNFda9p-39" style="text;strokeColor=none;fillColor=none;align=left;verticalAlign=top;spacingLeft=4;spacingRight=4;overflow=hidden;rotatable=0;points=[[0,0.5],[1,0.5]];portConstraint=eastwest;fontSize=14;" value="+finishedMLUExecution() : bool" vertex="1">
          <mxGeometry height="29" width="286" y="326.9230769230769" as="geometry" />
        </mxCell>
        <mxCell id="GRuPrAwGHJj99uNFda9p-52" parent="GRuPrAwGHJj99uNFda9p-39" style="text;strokeColor=none;fillColor=none;align=left;verticalAlign=top;spacingLeft=4;spacingRight=4;overflow=hidden;rotatable=0;points=[[0,0.5],[1,0.5]];portConstraint=eastwest;fontSize=14;" value="-synchronizeStreams() : void" vertex="1">
          <mxGeometry height="29" width="286" y="355.9230769230769" as="geometry" />
        </mxCell>
        <mxCell id="GRuPrAwGHJj99uNFda9p-53" parent="1" style="swimlane;fontStyle=1;align=center;verticalAlign=top;childLayout=stackLayout;horizontal=1;startSize=32;horizontalStack=0;resizeParent=1;resizeParentMax=0;resizeLast=0;collapsible=0;marginBottom=0;fontSize=14;" value="CNCLComm" vertex="1">
          <mxGeometry height="264" width="500" x="1191" y="1644" as="geometry" />
        </mxCell>
        <mxCell id="GRuPrAwGHJj99uNFda9p-54" parent="GRuPrAwGHJj99uNFda9p-53" style="text;strokeColor=none;fillColor=none;align=left;verticalAlign=top;spacingLeft=4;spacingRight=4;overflow=hidden;rotatable=0;points=[[0,0.5],[1,0.5]];portConstraint=eastwest;fontSize=14;" value="-cncl_comm_ : cnclComm_t" vertex="1">
          <mxGeometry height="32" width="500" y="32" as="geometry" />
        </mxCell>
        <mxCell id="GRuPrAwGHJj99uNFda9p-55" parent="GRuPrAwGHJj99uNFda9p-53" style="text;strokeColor=none;fillColor=none;align=left;verticalAlign=top;spacingLeft=4;spacingRight=4;overflow=hidden;rotatable=0;points=[[0,0.5],[1,0.5]];portConstraint=eastwest;fontSize=14;" value="-cncl_id_ : cnclCliqueId" vertex="1">
          <mxGeometry height="32" width="500" y="64" as="geometry" />
        </mxCell>
        <mxCell id="GRuPrAwGHJj99uNFda9p-56" parent="GRuPrAwGHJj99uNFda9p-53" style="text;strokeColor=none;fillColor=none;align=left;verticalAlign=top;spacingLeft=4;spacingRight=4;overflow=hidden;rotatable=0;points=[[0,0.5],[1,0.5]];portConstraint=eastwest;fontSize=14;" value="-rank_ : int" vertex="1">
          <mxGeometry height="32" width="500" y="96" as="geometry" />
        </mxCell>
        <mxCell id="GRuPrAwGHJj99uNFda9p-57" parent="GRuPrAwGHJj99uNFda9p-53" style="line;strokeWidth=1;fillColor=none;align=left;verticalAlign=middle;spacingTop=-1;spacingLeft=3;spacingRight=3;rotatable=0;labelPosition=right;points=[];portConstraint=eastwest;strokeColor=inherit;fontSize=14;" vertex="1">
          <mxGeometry height="8" width="500" y="128" as="geometry" />
        </mxCell>
        <mxCell id="GRuPrAwGHJj99uNFda9p-58" parent="GRuPrAwGHJj99uNFda9p-53" style="text;strokeColor=none;fillColor=none;align=left;verticalAlign=top;spacingLeft=4;spacingRight=4;overflow=hidden;rotatable=0;points=[[0,0.5],[1,0.5]];portConstraint=eastwest;fontSize=14;" value="+create(numRanks, rank, device, clique_id) : CNCLCommPtr" vertex="1">
          <mxGeometry height="32" width="500" y="136" as="geometry" />
        </mxCell>
        <mxCell id="GRuPrAwGHJj99uNFda9p-59" parent="GRuPrAwGHJj99uNFda9p-53" style="text;strokeColor=none;fillColor=none;align=left;verticalAlign=top;spacingLeft=4;spacingRight=4;overflow=hidden;rotatable=0;points=[[0,0.5],[1,0.5]];portConstraint=eastwest;fontSize=14;" value="+getCnclComm() : cnclComm_t" vertex="1">
          <mxGeometry height="32" width="500" y="168" as="geometry" />
        </mxCell>
        <mxCell id="GRuPrAwGHJj99uNFda9p-60" parent="GRuPrAwGHJj99uNFda9p-53" style="text;strokeColor=none;fillColor=none;align=left;verticalAlign=top;spacingLeft=4;spacingRight=4;overflow=hidden;rotatable=0;points=[[0,0.5],[1,0.5]];portConstraint=eastwest;fontSize=14;" value="+cnclCommAbort()" vertex="1">
          <mxGeometry height="32" width="500" y="200" as="geometry" />
        </mxCell>
        <mxCell id="GRuPrAwGHJj99uNFda9p-61" parent="GRuPrAwGHJj99uNFda9p-53" style="text;strokeColor=none;fillColor=none;align=left;verticalAlign=top;spacingLeft=4;spacingRight=4;overflow=hidden;rotatable=0;points=[[0,0.5],[1,0.5]];portConstraint=eastwest;fontSize=14;" value="+checkForCnclError()" vertex="1">
          <mxGeometry height="32" width="500" y="232" as="geometry" />
        </mxCell>
        <mxCell id="GRuPrAwGHJj99uNFda9p-62" parent="1" style="align=left;spacingLeft=4;fontSize=14;" value="实现细节重点:&#xa;1. getCNCLComm: 负责初始化或从 map 中获取 Communicator&#xa;2. pointToPoint: 模板函数，send/recv 都会调用它&#xa;3. dev_cncl_comm_map_: 避免重复创建连接" vertex="1">
          <mxGeometry height="89" width="488" x="516" y="376" as="geometry" />
        </mxCell>
        <mxCell id="GRuPrAwGHJj99uNFda9p-63" parent="1" style="align=left;spacingLeft=4;fontSize=14;" value="实现细节重点:&#xa;1. synchronizeStreams: 让计算流等待通信流&#xa;2. event: 用于判断硬件是否执行完成" vertex="1">
          <mxGeometry height="73" width="301" x="1543" y="1113" as="geometry" />
        </mxCell>
        <mxCell id="GRuPrAwGHJj99uNFda9p-64" edge="1" parent="1" source="GRuPrAwGHJj99uNFda9p-62" style="curved=1;dashed=1;dashPattern=2 3;startArrow=none;endArrow=none;exitX=0.5;exitY=1;entryX=0;entryY=0.12;rounded=0;fontSize=14;" target="GRuPrAwGHJj99uNFda9p-16" value="">
          <mxGeometry relative="1" as="geometry">
            <Array as="points">
              <mxPoint x="659" y="451" />
            </Array>
          </mxGeometry>
        </mxCell>
        <mxCell id="GRuPrAwGHJj99uNFda9p-65" edge="1" parent="1" source="GRuPrAwGHJj99uNFda9p-63" style="curved=1;dashed=1;dashPattern=2 3;startArrow=none;endArrow=none;exitX=0.5;exitY=1;entryX=0;entryY=0.27;rounded=0;fontSize=14;" target="GRuPrAwGHJj99uNFda9p-39" value="">
          <mxGeometry relative="1" as="geometry">
            <Array as="points">
              <mxPoint x="1676" y="1125" />
            </Array>
          </mxGeometry>
        </mxCell>
        <mxCell id="GRuPrAwGHJj99uNFda9p-66" edge="1" parent="1" source="GRuPrAwGHJj99uNFda9p-1" style="curved=1;startArrow=block;startSize=16;startFill=0;endArrow=none;exitX=0.5;exitY=1;entryX=1;entryY=0.12;rounded=0;fontSize=14;" target="GRuPrAwGHJj99uNFda9p-16" value="Inherits">
          <mxGeometry relative="1" as="geometry">
            <Array as="points">
              <mxPoint x="1446" y="451" />
            </Array>
          </mxGeometry>
        </mxCell>
        <mxCell id="GRuPrAwGHJj99uNFda9p-67" edge="1" parent="1" source="GRuPrAwGHJj99uNFda9p-7" style="curved=1;startArrow=block;startSize=16;startFill=0;endArrow=none;exitX=0.42;exitY=1;entryX=0.9;entryY=0;rounded=0;fontSize=14;" target="GRuPrAwGHJj99uNFda9p-39" value="Inherits">
          <mxGeometry relative="1" as="geometry">
            <Array as="points">
              <mxPoint x="2177" y="1125" />
            </Array>
          </mxGeometry>
        </mxCell>
        <mxCell id="GRuPrAwGHJj99uNFda9p-68" edge="1" parent="1" source="GRuPrAwGHJj99uNFda9p-16" style="curved=1;startArrow=diamondThin;startSize=14;startFill=0;endArrow=none;exitX=0.22;exitY=1;entryX=0.5;entryY=0;rounded=0;fontSize=14;" target="GRuPrAwGHJj99uNFda9p-11" value="使用 Store 交换 ID">
          <mxGeometry relative="1" as="geometry">
            <Array as="points">
              <mxPoint x="882" y="1125" />
            </Array>
          </mxGeometry>
        </mxCell>
        <mxCell id="GRuPrAwGHJj99uNFda9p-69" edge="1" parent="1" source="GRuPrAwGHJj99uNFda9p-16" style="curved=1;startArrow=diamondThin;startSize=14;startFill=0;endArrow=none;exitX=0.6;exitY=1;entryX=0.02;entryY=0;rounded=0;fontSize=14;" target="GRuPrAwGHJj99uNFda9p-53" value="Cache (dev_cncl_comm_map_)">
          <mxGeometry relative="1" as="geometry">
            <Array as="points">
              <mxPoint x="1111" y="1125" />
              <mxPoint x="1111" y="1595" />
            </Array>
          </mxGeometry>
        </mxCell>
        <mxCell id="GRuPrAwGHJj99uNFda9p-70" edge="1" parent="1" source="GRuPrAwGHJj99uNFda9p-16" style="curved=1;dashed=1;startArrow=none;endArrow=open;endSize=12;exitX=1;exitY=0.62;entryX=1;entryY=0.16;rounded=0;fontSize=14;" target="GRuPrAwGHJj99uNFda9p-39" value="Creates &amp; Returns">
          <mxGeometry relative="1" as="geometry">
            <Array as="points">
              <mxPoint x="1856" y="918" />
              <mxPoint x="2289" y="1125" />
            </Array>
          </mxGeometry>
        </mxCell>
        <mxCell id="GRuPrAwGHJj99uNFda9p-71" edge="1" parent="1" source="GRuPrAwGHJj99uNFda9p-39" style="curved=1;startArrow=none;endArrow=open;endSize=12;exitX=0.5;exitY=1;entryX=1;entryY=0.21;rounded=0;fontSize=14;" target="GRuPrAwGHJj99uNFda9p-53" value="Holds Reference (防止 Comm 被析构)">
          <mxGeometry relative="1" as="geometry">
            <Array as="points">
              <mxPoint x="2041" y="1595" />
            </Array>
          </mxGeometry>
        </mxCell>
        <mxCell id="j7ZJ0DfRaMBOnBrSPlp6-1" parent="1" style="whiteSpace=wrap;strokeWidth=2;fontSize=14;" value="Process 1 (Receiver)" vertex="1">
          <mxGeometry height="1094" width="360" x="2676" y="702" as="geometry" />
        </mxCell>
        <mxCell id="j7ZJ0DfRaMBOnBrSPlp6-2" parent="1" style="whiteSpace=wrap;strokeWidth=2;fontSize=14;" value="Store (TCP/File)" vertex="1">
          <mxGeometry height="179" width="214" x="3056" y="855" as="geometry" />
        </mxCell>
        <mxCell id="j7ZJ0DfRaMBOnBrSPlp6-3" parent="1" style="whiteSpace=wrap;strokeWidth=2;fontSize=14;" value="Process 0 (Sender)" vertex="1">
          <mxGeometry height="1122" width="366" x="3289" y="218" as="geometry" />
        </mxCell>
        <mxCell id="j7ZJ0DfRaMBOnBrSPlp6-4" parent="1" style="whiteSpace=wrap;strokeWidth=2;fontSize=14;" value="dist.send call" vertex="1">
          <mxGeometry height="54" width="156" x="3413" y="243" as="geometry" />
        </mxCell>
        <mxCell id="j7ZJ0DfRaMBOnBrSPlp6-5" parent="1" style="rhombus;strokeWidth=2;whiteSpace=wrap;fontSize=14;" value="Cache Hit?" vertex="1">
          <mxGeometry height="129" width="129" x="3426" y="371" as="geometry" />
        </mxCell>
        <mxCell id="j7ZJ0DfRaMBOnBrSPlp6-6" parent="1" style="whiteSpace=wrap;strokeWidth=2;fontSize=14;" value="cnclGetCliqueId&#xa;Generate UniqueID" vertex="1">
          <mxGeometry height="78" width="196" x="3324" y="574" as="geometry" />
        </mxCell>
        <mxCell id="j7ZJ0DfRaMBOnBrSPlp6-7" parent="1" style="whiteSpace=wrap;strokeWidth=2;fontSize=14;" value="store.set: key, ID" vertex="1">
          <mxGeometry height="54" width="182" x="3331" y="727" as="geometry" />
        </mxCell>
        <mxCell id="j7ZJ0DfRaMBOnBrSPlp6-8" parent="1" style="whiteSpace=wrap;strokeWidth=2;fontSize=14;" value="cnclInitComms&#xa;Create Comm" vertex="1">
          <mxGeometry height="78" width="165" x="3365" y="906" as="geometry" />
        </mxCell>
        <mxCell id="j7ZJ0DfRaMBOnBrSPlp6-9" parent="1" style="whiteSpace=wrap;strokeWidth=2;fontSize=14;" value="cnclSend&#xa;Submit Task" vertex="1">
          <mxGeometry height="78" width="144" x="3444" y="1133" as="geometry" />
        </mxCell>
        <mxCell id="j7ZJ0DfRaMBOnBrSPlp6-10" parent="1" style="whiteSpace=wrap;strokeWidth=2;fontSize=14;" value="Return WorkCNCL" vertex="1">
          <mxGeometry height="54" width="185" x="3423" y="1261" as="geometry" />
        </mxCell>
        <mxCell id="j7ZJ0DfRaMBOnBrSPlp6-11" parent="1" style="shape=cylinder3;boundedLbl=1;backgroundOutline=1;size=10;strokeWidth=2;whiteSpace=wrap;fontSize=14;" value="Key-Value Storage" vertex="1">
          <mxGeometry height="79" width="144" x="3091" y="906" as="geometry" />
        </mxCell>
        <mxCell id="j7ZJ0DfRaMBOnBrSPlp6-12" parent="1" style="whiteSpace=wrap;strokeWidth=2;fontSize=14;" value="dist.recv call" vertex="1">
          <mxGeometry height="54" width="153" x="2811" y="727" as="geometry" />
        </mxCell>
        <mxCell id="j7ZJ0DfRaMBOnBrSPlp6-13" parent="1" style="rhombus;strokeWidth=2;whiteSpace=wrap;fontSize=14;" value="Cache Hit?" vertex="1">
          <mxGeometry height="129" width="129" x="2823" y="880" as="geometry" />
        </mxCell>
        <mxCell id="j7ZJ0DfRaMBOnBrSPlp6-14" parent="1" style="whiteSpace=wrap;strokeWidth=2;fontSize=14;" value="store.wait: key" vertex="1">
          <mxGeometry height="54" width="169" x="2740" y="1145" as="geometry" />
        </mxCell>
        <mxCell id="j7ZJ0DfRaMBOnBrSPlp6-15" parent="1" style="whiteSpace=wrap;strokeWidth=2;fontSize=14;" value="store.get: key" vertex="1">
          <mxGeometry height="54" width="161" x="2744" y="1261" as="geometry" />
        </mxCell>
        <mxCell id="j7ZJ0DfRaMBOnBrSPlp6-16" parent="1" style="whiteSpace=wrap;strokeWidth=2;fontSize=14;" value="cnclInitComms&#xa;Create Comm" vertex="1">
          <mxGeometry height="78" width="165" x="2742" y="1414" as="geometry" />
        </mxCell>
        <mxCell id="j7ZJ0DfRaMBOnBrSPlp6-17" parent="1" style="whiteSpace=wrap;strokeWidth=2;fontSize=14;" value="cnclRecv&#xa;Submit Task" vertex="1">
          <mxGeometry height="78" width="144" x="2815" y="1590" as="geometry" />
        </mxCell>
        <mxCell id="j7ZJ0DfRaMBOnBrSPlp6-18" parent="1" style="whiteSpace=wrap;strokeWidth=2;fontSize=14;" value="Return WorkCNCL" vertex="1">
          <mxGeometry height="54" width="185" x="2795" y="1718" as="geometry" />
        </mxCell>
        <mxCell id="j7ZJ0DfRaMBOnBrSPlp6-19" edge="1" parent="1" source="j7ZJ0DfRaMBOnBrSPlp6-4" style="curved=1;startArrow=none;endArrow=block;exitX=0.5;exitY=1;entryX=0.5;entryY=0;rounded=0;fontSize=14;" target="j7ZJ0DfRaMBOnBrSPlp6-5" value="调用 send">
          <mxGeometry relative="1" as="geometry">
            <Array as="points" />
          </mxGeometry>
        </mxCell>
        <mxCell id="j7ZJ0DfRaMBOnBrSPlp6-20" edge="1" parent="1" source="j7ZJ0DfRaMBOnBrSPlp6-12" style="curved=1;startArrow=none;endArrow=block;exitX=0.5;exitY=1.01;entryX=0.5;entryY=0;rounded=0;fontSize=14;" target="j7ZJ0DfRaMBOnBrSPlp6-13" value="调用 recv">
          <mxGeometry relative="1" as="geometry">
            <Array as="points" />
          </mxGeometry>
        </mxCell>
        <mxCell id="j7ZJ0DfRaMBOnBrSPlp6-21" edge="1" parent="1" source="j7ZJ0DfRaMBOnBrSPlp6-5" style="curved=1;startArrow=none;endArrow=block;exitX=0.17;exitY=1;entryX=0.5;entryY=0.01;rounded=0;fontSize=14;" target="j7ZJ0DfRaMBOnBrSPlp6-6" value="No (First Time)">
          <mxGeometry relative="1" as="geometry">
            <Array as="points">
              <mxPoint x="3422" y="537" />
            </Array>
          </mxGeometry>
        </mxCell>
        <mxCell id="j7ZJ0DfRaMBOnBrSPlp6-22" edge="1" parent="1" source="j7ZJ0DfRaMBOnBrSPlp6-6" style="curved=1;startArrow=none;endArrow=block;exitX=0.5;exitY=1.01;entryX=0.5;entryY=0.01;rounded=0;fontSize=14;" target="j7ZJ0DfRaMBOnBrSPlp6-7" value="">
          <mxGeometry relative="1" as="geometry">
            <Array as="points" />
          </mxGeometry>
        </mxCell>
        <mxCell id="j7ZJ0DfRaMBOnBrSPlp6-23" edge="1" parent="1" source="j7ZJ0DfRaMBOnBrSPlp6-7" style="curved=1;dashed=1;dashPattern=2 3;startArrow=none;endArrow=block;exitX=0.41;exitY=1.01;entryX=1;entryY=0.12;rounded=0;fontSize=14;" target="j7ZJ0DfRaMBOnBrSPlp6-11" value="Network">
          <mxGeometry relative="1" as="geometry">
            <Array as="points">
              <mxPoint x="3381" y="818" />
              <mxPoint x="3381" y="855" />
            </Array>
          </mxGeometry>
        </mxCell>
        <mxCell id="j7ZJ0DfRaMBOnBrSPlp6-24" edge="1" parent="1" source="j7ZJ0DfRaMBOnBrSPlp6-13" style="curved=1;startArrow=none;endArrow=block;exitX=0;exitY=0.91;entryX=0.41;entryY=0;rounded=0;fontSize=14;" target="j7ZJ0DfRaMBOnBrSPlp6-14" value="No (First Time)">
          <mxGeometry relative="1" as="geometry">
            <Array as="points">
              <mxPoint x="2777" y="1035" />
              <mxPoint x="2777" y="1084" />
            </Array>
          </mxGeometry>
        </mxCell>
        <mxCell id="j7ZJ0DfRaMBOnBrSPlp6-25" edge="1" parent="1" source="j7ZJ0DfRaMBOnBrSPlp6-11" style="curved=1;dashed=1;dashPattern=2 3;startArrow=none;endArrow=block;exitX=0.5;exitY=1;entryX=0.59;entryY=0;rounded=0;fontSize=14;" target="j7ZJ0DfRaMBOnBrSPlp6-14" value="Notify">
          <mxGeometry relative="1" as="geometry">
            <Array as="points">
              <mxPoint x="3163" y="1035" />
              <mxPoint x="2872" y="1084" />
            </Array>
          </mxGeometry>
        </mxCell>
        <mxCell id="j7ZJ0DfRaMBOnBrSPlp6-26" edge="1" parent="1" source="j7ZJ0DfRaMBOnBrSPlp6-14" style="curved=1;startArrow=none;endArrow=block;exitX=0.5;exitY=1;entryX=0.5;entryY=0;rounded=0;fontSize=14;" target="j7ZJ0DfRaMBOnBrSPlp6-15" value="">
          <mxGeometry relative="1" as="geometry">
            <Array as="points" />
          </mxGeometry>
        </mxCell>
        <mxCell id="j7ZJ0DfRaMBOnBrSPlp6-27" edge="1" parent="1" source="j7ZJ0DfRaMBOnBrSPlp6-15" style="curved=1;startArrow=none;endArrow=block;exitX=0.5;exitY=1;entryX=0.5;entryY=0;rounded=0;fontSize=14;" target="j7ZJ0DfRaMBOnBrSPlp6-16" value="Get UniqueID">
          <mxGeometry relative="1" as="geometry">
            <Array as="points" />
          </mxGeometry>
        </mxCell>
        <mxCell id="j7ZJ0DfRaMBOnBrSPlp6-28" edge="1" parent="1" source="j7ZJ0DfRaMBOnBrSPlp6-7" style="curved=1;startArrow=none;endArrow=block;exitX=0.56;exitY=1.01;entryX=0.5;entryY=0;rounded=0;fontSize=14;" target="j7ZJ0DfRaMBOnBrSPlp6-8" value="">
          <mxGeometry relative="1" as="geometry">
            <Array as="points">
              <mxPoint x="3447" y="818" />
            </Array>
          </mxGeometry>
        </mxCell>
        <mxCell id="j7ZJ0DfRaMBOnBrSPlp6-29" edge="1" parent="1" source="j7ZJ0DfRaMBOnBrSPlp6-8" style="curved=1;startArrow=none;endArrow=block;exitX=0.5;exitY=1;entryX=0.29;entryY=0;rounded=0;fontSize=14;" target="j7ZJ0DfRaMBOnBrSPlp6-9" value="Store into dev_cncl_comm_map_">
          <mxGeometry relative="1" as="geometry">
            <Array as="points">
              <mxPoint x="3447" y="1084" />
            </Array>
          </mxGeometry>
        </mxCell>
        <mxCell id="j7ZJ0DfRaMBOnBrSPlp6-30" edge="1" parent="1" source="j7ZJ0DfRaMBOnBrSPlp6-16" style="curved=1;startArrow=none;endArrow=block;exitX=0.5;exitY=1;entryX=0.31;entryY=0;rounded=0;fontSize=14;" target="j7ZJ0DfRaMBOnBrSPlp6-17" value="Store into dev_cncl_comm_map_">
          <mxGeometry relative="1" as="geometry">
            <Array as="points">
              <mxPoint x="2824" y="1541" />
            </Array>
          </mxGeometry>
        </mxCell>
        <mxCell id="j7ZJ0DfRaMBOnBrSPlp6-31" edge="1" parent="1" source="j7ZJ0DfRaMBOnBrSPlp6-5" style="curved=1;startArrow=none;endArrow=block;exitX=0.92;exitY=1;entryX=0.69;entryY=0;rounded=0;fontSize=14;" target="j7ZJ0DfRaMBOnBrSPlp6-9" value="Yes">
          <mxGeometry relative="1" as="geometry">
            <Array as="points">
              <mxPoint x="3576" y="537" />
              <mxPoint x="3576" y="1084" />
            </Array>
          </mxGeometry>
        </mxCell>
        <mxCell id="j7ZJ0DfRaMBOnBrSPlp6-32" edge="1" parent="1" source="j7ZJ0DfRaMBOnBrSPlp6-13" style="curved=1;startArrow=none;endArrow=block;exitX=0.88;exitY=1.01;entryX=0.72;entryY=0;rounded=0;fontSize=14;" target="j7ZJ0DfRaMBOnBrSPlp6-17" value="Yes">
          <mxGeometry relative="1" as="geometry">
            <Array as="points">
              <mxPoint x="2956" y="1035" />
              <mxPoint x="2956" y="1541" />
            </Array>
          </mxGeometry>
        </mxCell>
        <mxCell id="j7ZJ0DfRaMBOnBrSPlp6-33" edge="1" parent="1" source="j7ZJ0DfRaMBOnBrSPlp6-9" style="curved=1;startArrow=none;endArrow=block;exitX=0.5;exitY=1;entryX=0.5;entryY=0;rounded=0;fontSize=14;" target="j7ZJ0DfRaMBOnBrSPlp6-10" value="">
          <mxGeometry relative="1" as="geometry">
            <Array as="points" />
          </mxGeometry>
        </mxCell>
        <mxCell id="j7ZJ0DfRaMBOnBrSPlp6-34" edge="1" parent="1" source="j7ZJ0DfRaMBOnBrSPlp6-17" style="curved=1;startArrow=none;endArrow=block;exitX=0.5;exitY=1;entryX=0.5;entryY=0;rounded=0;fontSize=14;" target="j7ZJ0DfRaMBOnBrSPlp6-18" value="">
          <mxGeometry relative="1" as="geometry">
            <Array as="points" />
          </mxGeometry>
        </mxCell>
        <mxCell id="j7ZJ0DfRaMBOnBrSPlp6-35" parent="1" style="shape=umlLifeline;perimeter=lifelinePerimeter;whiteSpace=wrap;container=1;dropTarget=0;collapsible=0;recursiveResize=0;outlineConnect=0;portConstraint=eastwest;newEdgeStyle={&quot;edgeStyle&quot;:&quot;elbowEdgeStyle&quot;,&quot;elbow&quot;:&quot;vertical&quot;,&quot;curved&quot;:0,&quot;rounded&quot;:0};participant=umlActor;verticalAlign=bottom;labelPosition=center;verticalLabelPosition=top;align=center;size=65;fontSize=14;" value="Python User (Rank 0)" vertex="1">
          <mxGeometry height="2483" width="28" x="984" y="2678" as="geometry" />
        </mxCell>
        <mxCell id="j7ZJ0DfRaMBOnBrSPlp6-36" parent="1" style="shape=umlLifeline;perimeter=lifelinePerimeter;whiteSpace=wrap;container=1;dropTarget=0;collapsible=0;recursiveResize=0;outlineConnect=0;portConstraint=eastwest;newEdgeStyle={&quot;edgeStyle&quot;:&quot;elbowEdgeStyle&quot;,&quot;elbow&quot;:&quot;vertical&quot;,&quot;curved&quot;:0,&quot;rounded&quot;:0};size=65;fontSize=14;" value="ProcessGroupMyBackend&#xa;(C++ Class)" vertex="1">
          <mxGeometry height="2482" width="211" x="1278" y="2679" as="geometry" />
        </mxCell>
        <mxCell id="j7ZJ0DfRaMBOnBrSPlp6-37" parent="j7ZJ0DfRaMBOnBrSPlp6-36" style="points=[];perimeter=orthogonalPerimeter;outlineConnect=0;targetShapes=umlLifeline;portConstraint=eastwest;newEdgeStyle={&quot;edgeStyle&quot;:&quot;elbowEdgeStyle&quot;,&quot;elbow&quot;:&quot;vertical&quot;,&quot;curved&quot;:0,&quot;rounded&quot;:0};fontSize=14;" value="" vertex="1">
          <mxGeometry height="2000" width="10" x="101" y="178" as="geometry" />
        </mxCell>
        <mxCell id="j7ZJ0DfRaMBOnBrSPlp6-38" parent="j7ZJ0DfRaMBOnBrSPlp6-36" style="points=[];perimeter=orthogonalPerimeter;outlineConnect=0;targetShapes=umlLifeline;portConstraint=eastwest;newEdgeStyle={&quot;edgeStyle&quot;:&quot;elbowEdgeStyle&quot;,&quot;elbow&quot;:&quot;vertical&quot;,&quot;curved&quot;:0,&quot;rounded&quot;:0};fontSize=14;" value="" vertex="1">
          <mxGeometry height="769" width="10" x="106" y="719" as="geometry" />
        </mxCell>
        <mxCell id="j7ZJ0DfRaMBOnBrSPlp6-39" parent="j7ZJ0DfRaMBOnBrSPlp6-36" style="points=[];perimeter=orthogonalPerimeter;outlineConnect=0;targetShapes=umlLifeline;portConstraint=eastwest;newEdgeStyle={&quot;edgeStyle&quot;:&quot;elbowEdgeStyle&quot;,&quot;elbow&quot;:&quot;vertical&quot;,&quot;curved&quot;:0,&quot;rounded&quot;:0};fontSize=14;" value="" vertex="1">
          <mxGeometry height="456" width="10" x="106" y="1656" as="geometry" />
        </mxCell>
        <mxCell id="j7ZJ0DfRaMBOnBrSPlp6-40" parent="1" style="shape=umlLifeline;perimeter=lifelinePerimeter;whiteSpace=wrap;container=1;dropTarget=0;collapsible=0;recursiveResize=0;outlineConnect=0;portConstraint=eastwest;newEdgeStyle={&quot;edgeStyle&quot;:&quot;elbowEdgeStyle&quot;,&quot;elbow&quot;:&quot;vertical&quot;,&quot;curved&quot;:0,&quot;rounded&quot;:0};size=65;fontSize=14;" value="dev_comm_map_&#xa;(Member Variable)" vertex="1">
          <mxGeometry height="2482" width="157" x="1640" y="2679" as="geometry" />
        </mxCell>
        <mxCell id="j7ZJ0DfRaMBOnBrSPlp6-41" parent="1" style="shape=umlLifeline;perimeter=lifelinePerimeter;whiteSpace=wrap;container=1;dropTarget=0;collapsible=0;recursiveResize=0;outlineConnect=0;portConstraint=eastwest;newEdgeStyle={&quot;edgeStyle&quot;:&quot;elbowEdgeStyle&quot;,&quot;elbow&quot;:&quot;vertical&quot;,&quot;curved&quot;:0,&quot;rounded&quot;:0};size=65;fontSize=14;" value="Store&#xa;(TCP/File)" vertex="1">
          <mxGeometry height="2482" width="150" x="1847" y="2679" as="geometry" />
        </mxCell>
        <mxCell id="j7ZJ0DfRaMBOnBrSPlp6-42" parent="1" style="shape=umlLifeline;perimeter=lifelinePerimeter;whiteSpace=wrap;container=1;dropTarget=0;collapsible=0;recursiveResize=0;outlineConnect=0;portConstraint=eastwest;newEdgeStyle={&quot;edgeStyle&quot;:&quot;elbowEdgeStyle&quot;,&quot;elbow&quot;:&quot;vertical&quot;,&quot;curved&quot;:0,&quot;rounded&quot;:0};size=65;fontSize=14;" value="MyComm&#xa;(Hardware Wrapper)" vertex="1">
          <mxGeometry height="2482" width="171" x="2068" y="2679" as="geometry" />
        </mxCell>
        <mxCell id="j7ZJ0DfRaMBOnBrSPlp6-43" parent="j7ZJ0DfRaMBOnBrSPlp6-42" style="points=[];perimeter=orthogonalPerimeter;outlineConnect=0;targetShapes=umlLifeline;portConstraint=eastwest;newEdgeStyle={&quot;edgeStyle&quot;:&quot;elbowEdgeStyle&quot;,&quot;elbow&quot;:&quot;vertical&quot;,&quot;curved&quot;:0,&quot;rounded&quot;:0};fontSize=14;" value="" vertex="1">
          <mxGeometry height="46" width="10" x="80" y="1250" as="geometry" />
        </mxCell>
        <mxCell id="j7ZJ0DfRaMBOnBrSPlp6-44" parent="j7ZJ0DfRaMBOnBrSPlp6-42" style="points=[];perimeter=orthogonalPerimeter;outlineConnect=0;targetShapes=umlLifeline;portConstraint=eastwest;newEdgeStyle={&quot;edgeStyle&quot;:&quot;elbowEdgeStyle&quot;,&quot;elbow&quot;:&quot;vertical&quot;,&quot;curved&quot;:0,&quot;rounded&quot;:0};fontSize=14;" value="" vertex="1">
          <mxGeometry height="38" width="10" x="80" y="1888" as="geometry" />
        </mxCell>
        <mxCell id="j7ZJ0DfRaMBOnBrSPlp6-45" parent="1" style="shape=umlLifeline;perimeter=lifelinePerimeter;whiteSpace=wrap;container=1;dropTarget=0;collapsible=0;recursiveResize=0;outlineConnect=0;portConstraint=eastwest;newEdgeStyle={&quot;edgeStyle&quot;:&quot;elbowEdgeStyle&quot;,&quot;elbow&quot;:&quot;vertical&quot;,&quot;curved&quot;:0,&quot;rounded&quot;:0};size=65;fontSize=14;" value="MyWork&#xa;(Return Handle)" vertex="1">
          <mxGeometry height="2482" width="150" x="2367" y="2679" as="geometry" />
        </mxCell>
        <mxCell id="j7ZJ0DfRaMBOnBrSPlp6-46" parent="j7ZJ0DfRaMBOnBrSPlp6-45" style="points=[];perimeter=orthogonalPerimeter;outlineConnect=0;targetShapes=umlLifeline;portConstraint=eastwest;newEdgeStyle={&quot;edgeStyle&quot;:&quot;elbowEdgeStyle&quot;,&quot;elbow&quot;:&quot;vertical&quot;,&quot;curved&quot;:0,&quot;rounded&quot;:0};fontSize=14;" value="" vertex="1">
          <mxGeometry height="38" width="10" x="70" y="2064" as="geometry" />
        </mxCell>
        <mxCell id="j7ZJ0DfRaMBOnBrSPlp6-47" parent="j7ZJ0DfRaMBOnBrSPlp6-45" style="points=[];perimeter=orthogonalPerimeter;outlineConnect=0;targetShapes=umlLifeline;portConstraint=eastwest;newEdgeStyle={&quot;edgeStyle&quot;:&quot;elbowEdgeStyle&quot;,&quot;elbow&quot;:&quot;vertical&quot;,&quot;curved&quot;:0,&quot;rounded&quot;:0};fontSize=14;" value="" vertex="1">
          <mxGeometry height="114" width="10" x="70" y="2273" as="geometry" />
        </mxCell>
        <mxCell id="j7ZJ0DfRaMBOnBrSPlp6-48" parent="1" style="shape=umlFrame;dashed=1;pointerEvents=0;dropTarget=0;strokeColor=#B3B3B3;height=20;width=30;fontSize=14;" value="alt" vertex="1">
          <mxGeometry height="373" width="650" x="1284" y="3487" as="geometry" />
        </mxCell>
        <mxCell id="j7ZJ0DfRaMBOnBrSPlp6-49" parent="j7ZJ0DfRaMBOnBrSPlp6-48" style="text;strokeColor=none;fillColor=none;align=center;verticalAlign=middle;whiteSpace=wrap;fontSize=14;" value="[I am Rank 0 (Master)]" vertex="1">
          <mxGeometry height="20" width="620" x="30" as="geometry" />
        </mxCell>
        <mxCell id="j7ZJ0DfRaMBOnBrSPlp6-50" parent="j7ZJ0DfRaMBOnBrSPlp6-48" style="shape=line;dashed=1;whiteSpace=wrap;verticalAlign=top;labelPosition=center;verticalLabelPosition=middle;align=center;strokeColor=#B3B3B3;fontSize=14;" value="[I am Rank 1 (Worker)]" vertex="1">
          <mxGeometry height="4" width="650" y="218" as="geometry" />
        </mxCell>
        <mxCell id="j7ZJ0DfRaMBOnBrSPlp6-51" parent="1" style="shape=umlFrame;dashed=1;pointerEvents=0;dropTarget=0;strokeColor=#B3B3B3;height=20;width=0;fontSize=14;" value="" vertex="1">
          <mxGeometry height="587" width="895" x="1274" y="3418" as="geometry" />
        </mxCell>
        <mxCell id="j7ZJ0DfRaMBOnBrSPlp6-52" parent="j7ZJ0DfRaMBOnBrSPlp6-51" style="text;strokeColor=none;fillColor=none;align=center;verticalAlign=middle;whiteSpace=wrap;fontSize=14;" value="" vertex="1">
          <mxGeometry height="20" width="895" as="geometry" />
        </mxCell>
        <mxCell id="j7ZJ0DfRaMBOnBrSPlp6-53" parent="1" style="shape=umlFrame;dashed=1;pointerEvents=0;dropTarget=0;strokeColor=#B3B3B3;height=20;width=30;fontSize=14;" value="alt" vertex="1">
          <mxGeometry height="1007" width="920" x="1259" y="3180" as="geometry" />
        </mxCell>
        <mxCell id="j7ZJ0DfRaMBOnBrSPlp6-54" parent="j7ZJ0DfRaMBOnBrSPlp6-53" style="text;strokeColor=none;fillColor=none;align=center;verticalAlign=middle;whiteSpace=wrap;fontSize=14;" value="[Cache Hit (连接已存在)]" vertex="1">
          <mxGeometry height="20" width="890" x="30" as="geometry" />
        </mxCell>
        <mxCell id="j7ZJ0DfRaMBOnBrSPlp6-55" parent="j7ZJ0DfRaMBOnBrSPlp6-53" style="shape=line;dashed=1;whiteSpace=wrap;verticalAlign=top;labelPosition=center;verticalLabelPosition=middle;align=center;strokeColor=#B3B3B3;fontSize=14;" value="[Cache Miss (第一次通信)]" vertex="1">
          <mxGeometry height="4" width="920" y="109" as="geometry" />
        </mxCell>
        <mxCell id="j7ZJ0DfRaMBOnBrSPlp6-56" edge="1" parent="1" source="j7ZJ0DfRaMBOnBrSPlp6-35" style="verticalAlign=bottom;edgeStyle=elbowEdgeStyle;elbow=vertical;curved=0;rounded=0;endArrow=block;fontSize=14;" target="j7ZJ0DfRaMBOnBrSPlp6-37" value="send(tensors, dstRank=1, tag=0)">
          <mxGeometry relative="1" as="geometry">
            <Array as="points">
              <mxPoint x="1237" y="2857" />
            </Array>
          </mxGeometry>
        </mxCell>
        <mxCell id="j7ZJ0DfRaMBOnBrSPlp6-57" parent="j7ZJ0DfRaMBOnBrSPlp6-56" style="ellipse;aspect=fixed;fillColor=#000000;align=center;fontColor=#FFFFFF;fontSize=14;" value="1" vertex="1">
          <mxGeometry height="14" relative="1" width="14" as="geometry">
            <mxPoint x="-162.5" y="-7" as="offset" />
          </mxGeometry>
        </mxCell>
        <mxCell id="j7ZJ0DfRaMBOnBrSPlp6-58" edge="1" parent="1" source="j7ZJ0DfRaMBOnBrSPlp6-37" style="curved=1;endArrow=block;rounded=0;fontSize=14;" target="j7ZJ0DfRaMBOnBrSPlp6-37" value="1. check_tensors(tensors)&#xa;检查设备(Die 1)和连续性">
          <mxGeometry relative="1" as="geometry">
            <Array as="points">
              <mxPoint x="1439" y="2924" />
              <mxPoint x="1439" y="2954" />
            </Array>
          </mxGeometry>
        </mxCell>
        <mxCell id="j7ZJ0DfRaMBOnBrSPlp6-59" parent="j7ZJ0DfRaMBOnBrSPlp6-58" style="ellipse;aspect=fixed;fillColor=#000000;align=center;fontColor=#FFFFFF;fontSize=14;" value="2" vertex="1">
          <mxGeometry height="14" relative="1" width="14" as="geometry">
            <mxPoint x="-57" y="-26" as="offset" />
          </mxGeometry>
        </mxCell>
        <mxCell id="j7ZJ0DfRaMBOnBrSPlp6-60" edge="1" parent="1" source="j7ZJ0DfRaMBOnBrSPlp6-37" style="curved=1;endArrow=block;rounded=0;fontSize=14;" target="j7ZJ0DfRaMBOnBrSPlp6-37" value="2. getKey(devices, dstRank)&#xa;生成唯一Key (例如 &quot;1:0,1&quot;)">
          <mxGeometry relative="1" as="geometry">
            <Array as="points">
              <mxPoint x="1439" y="3033" />
              <mxPoint x="1439" y="3063" />
            </Array>
          </mxGeometry>
        </mxCell>
        <mxCell id="j7ZJ0DfRaMBOnBrSPlp6-61" parent="j7ZJ0DfRaMBOnBrSPlp6-60" style="ellipse;aspect=fixed;fillColor=#000000;align=center;fontColor=#FFFFFF;fontSize=14;" value="3" vertex="1">
          <mxGeometry height="14" relative="1" width="14" as="geometry">
            <mxPoint x="-57" y="-28" as="offset" />
          </mxGeometry>
        </mxCell>
        <mxCell id="j7ZJ0DfRaMBOnBrSPlp6-62" edge="1" parent="1" source="j7ZJ0DfRaMBOnBrSPlp6-37" style="verticalAlign=bottom;edgeStyle=elbowEdgeStyle;elbow=vertical;curved=0;rounded=0;endArrow=block;fontSize=14;" target="j7ZJ0DfRaMBOnBrSPlp6-40" value="find(key)">
          <mxGeometry relative="1" as="geometry">
            <Array as="points">
              <mxPoint x="1562" y="3160" />
            </Array>
          </mxGeometry>
        </mxCell>
        <mxCell id="j7ZJ0DfRaMBOnBrSPlp6-63" parent="j7ZJ0DfRaMBOnBrSPlp6-62" style="ellipse;aspect=fixed;fillColor=#000000;align=center;fontColor=#FFFFFF;fontSize=14;" value="4" vertex="1">
          <mxGeometry height="14" relative="1" width="14" as="geometry">
            <mxPoint x="-173" y="-7" as="offset" />
          </mxGeometry>
        </mxCell>
        <mxCell id="j7ZJ0DfRaMBOnBrSPlp6-64" edge="1" parent="1" source="j7ZJ0DfRaMBOnBrSPlp6-40" style="verticalAlign=bottom;edgeStyle=elbowEdgeStyle;elbow=vertical;curved=0;rounded=0;dashed=1;dashPattern=2 3;endArrow=block;fontSize=14;" target="j7ZJ0DfRaMBOnBrSPlp6-37" value="return comm">
          <mxGeometry relative="1" as="geometry">
            <Array as="points">
              <mxPoint x="1565" y="3264" />
            </Array>
          </mxGeometry>
        </mxCell>
        <mxCell id="j7ZJ0DfRaMBOnBrSPlp6-65" parent="j7ZJ0DfRaMBOnBrSPlp6-64" style="ellipse;aspect=fixed;fillColor=#000000;align=center;fontColor=#FFFFFF;fontSize=14;" value="5" vertex="1">
          <mxGeometry height="14" relative="1" width="14" as="geometry">
            <mxPoint x="159" y="-7" as="offset" />
          </mxGeometry>
        </mxCell>
        <mxCell id="j7ZJ0DfRaMBOnBrSPlp6-66" edge="1" parent="1" source="j7ZJ0DfRaMBOnBrSPlp6-37" style="curved=1;endArrow=block;rounded=0;fontSize=14;" target="j7ZJ0DfRaMBOnBrSPlp6-37" value="getCNCLComm(key, devices, ...)">
          <mxGeometry relative="1" as="geometry">
            <Array as="points">
              <mxPoint x="1439" y="3368" />
              <mxPoint x="1439" y="3398" />
            </Array>
          </mxGeometry>
        </mxCell>
        <mxCell id="j7ZJ0DfRaMBOnBrSPlp6-67" parent="j7ZJ0DfRaMBOnBrSPlp6-66" style="ellipse;aspect=fixed;fillColor=#000000;align=center;fontColor=#FFFFFF;fontSize=14;" value="6" vertex="1">
          <mxGeometry height="14" relative="1" width="14" as="geometry">
            <mxPoint x="-57" y="-22" as="offset" />
          </mxGeometry>
        </mxCell>
        <mxCell id="j7ZJ0DfRaMBOnBrSPlp6-68" edge="1" parent="1" source="j7ZJ0DfRaMBOnBrSPlp6-37" style="curved=1;endArrow=block;rounded=0;fontSize=14;" target="j7ZJ0DfRaMBOnBrSPlp6-37" value="generate_unique_id() -&gt; ID">
          <mxGeometry relative="1" as="geometry">
            <Array as="points">
              <mxPoint x="1444" y="3571" />
              <mxPoint x="1444" y="3601" />
            </Array>
          </mxGeometry>
        </mxCell>
        <mxCell id="j7ZJ0DfRaMBOnBrSPlp6-69" parent="j7ZJ0DfRaMBOnBrSPlp6-68" style="ellipse;aspect=fixed;fillColor=#000000;align=center;fontColor=#FFFFFF;fontSize=14;" value="7" vertex="1">
          <mxGeometry height="14" relative="1" width="14" as="geometry">
            <mxPoint x="-57" y="-22" as="offset" />
          </mxGeometry>
        </mxCell>
        <mxCell id="j7ZJ0DfRaMBOnBrSPlp6-70" edge="1" parent="1" source="j7ZJ0DfRaMBOnBrSPlp6-37" style="verticalAlign=bottom;edgeStyle=elbowEdgeStyle;elbow=vertical;curved=0;rounded=0;endArrow=block;fontSize=14;" target="j7ZJ0DfRaMBOnBrSPlp6-41" value="set(key, ID) &#xa;广播 ID 给 Rank 1">
          <mxGeometry relative="1" as="geometry">
            <Array as="points">
              <mxPoint x="1666" y="3680" />
            </Array>
          </mxGeometry>
        </mxCell>
        <mxCell id="j7ZJ0DfRaMBOnBrSPlp6-71" parent="j7ZJ0DfRaMBOnBrSPlp6-70" style="ellipse;aspect=fixed;fillColor=#000000;align=center;fontColor=#FFFFFF;fontSize=14;" value="8" vertex="1">
          <mxGeometry height="14" relative="1" width="14" as="geometry">
            <mxPoint x="-272.25" y="-7" as="offset" />
          </mxGeometry>
        </mxCell>
        <mxCell id="j7ZJ0DfRaMBOnBrSPlp6-72" edge="1" parent="1" source="j7ZJ0DfRaMBOnBrSPlp6-37" style="verticalAlign=bottom;edgeStyle=elbowEdgeStyle;elbow=vertical;curved=0;rounded=0;endArrow=block;fontSize=14;" target="j7ZJ0DfRaMBOnBrSPlp6-41" value="wait(key)">
          <mxGeometry relative="1" as="geometry">
            <Array as="points">
              <mxPoint x="1666" y="3784" />
            </Array>
          </mxGeometry>
        </mxCell>
        <mxCell id="j7ZJ0DfRaMBOnBrSPlp6-73" parent="j7ZJ0DfRaMBOnBrSPlp6-72" style="ellipse;aspect=fixed;fillColor=#000000;align=center;fontColor=#FFFFFF;fontSize=14;" value="9" vertex="1">
          <mxGeometry height="14" relative="1" width="14" as="geometry">
            <mxPoint x="-272.25" y="-7" as="offset" />
          </mxGeometry>
        </mxCell>
        <mxCell id="j7ZJ0DfRaMBOnBrSPlp6-74" edge="1" parent="1" source="j7ZJ0DfRaMBOnBrSPlp6-37" style="verticalAlign=bottom;edgeStyle=elbowEdgeStyle;elbow=vertical;curved=0;rounded=0;endArrow=block;fontSize=14;" target="j7ZJ0DfRaMBOnBrSPlp6-41" value="get(key) -&gt; ID">
          <mxGeometry relative="1" as="geometry">
            <Array as="points">
              <mxPoint x="1666" y="3840" />
            </Array>
          </mxGeometry>
        </mxCell>
        <mxCell id="j7ZJ0DfRaMBOnBrSPlp6-75" parent="j7ZJ0DfRaMBOnBrSPlp6-74" style="ellipse;aspect=fixed;fillColor=#000000;align=center;fontColor=#FFFFFF;fontSize=14;" value="10" vertex="1">
          <mxGeometry height="14" relative="1" width="14" as="geometry">
            <mxPoint x="-272.25" y="-7" as="offset" />
          </mxGeometry>
        </mxCell>
        <mxCell id="j7ZJ0DfRaMBOnBrSPlp6-76" edge="1" parent="1" source="j7ZJ0DfRaMBOnBrSPlp6-37" style="verticalAlign=bottom;edgeStyle=elbowEdgeStyle;elbow=vertical;curved=0;rounded=0;endArrow=block;fontSize=14;" target="j7ZJ0DfRaMBOnBrSPlp6-43" value="CNCLComm::create(ID, dev_idx, ...)&#xa;初始化底层硬件">
          <mxGeometry relative="1" as="geometry">
            <Array as="points">
              <mxPoint x="1781" y="3929" />
            </Array>
          </mxGeometry>
        </mxCell>
        <mxCell id="j7ZJ0DfRaMBOnBrSPlp6-77" parent="j7ZJ0DfRaMBOnBrSPlp6-76" style="ellipse;aspect=fixed;fillColor=#000000;align=center;fontColor=#FFFFFF;fontSize=14;" value="11" vertex="1">
          <mxGeometry height="14" relative="1" width="14" as="geometry">
            <mxPoint x="-387.75" y="-7" as="offset" />
          </mxGeometry>
        </mxCell>
        <mxCell id="j7ZJ0DfRaMBOnBrSPlp6-78" edge="1" parent="1" source="j7ZJ0DfRaMBOnBrSPlp6-42" style="verticalAlign=bottom;edgeStyle=elbowEdgeStyle;elbow=vertical;curved=0;rounded=0;dashed=1;dashPattern=2 3;endArrow=block;fontSize=14;" target="j7ZJ0DfRaMBOnBrSPlp6-37" value="return comm_handle">
          <mxGeometry relative="1" as="geometry">
            <Array as="points">
              <mxPoint x="1782" y="3985" />
            </Array>
          </mxGeometry>
        </mxCell>
        <mxCell id="j7ZJ0DfRaMBOnBrSPlp6-79" parent="j7ZJ0DfRaMBOnBrSPlp6-78" style="ellipse;aspect=fixed;fillColor=#000000;align=center;fontColor=#FFFFFF;fontSize=14;" value="12" vertex="1">
          <mxGeometry height="14" relative="1" width="14" as="geometry">
            <mxPoint x="371.75" y="-7" as="offset" />
          </mxGeometry>
        </mxCell>
        <mxCell id="j7ZJ0DfRaMBOnBrSPlp6-80" edge="1" parent="1" source="j7ZJ0DfRaMBOnBrSPlp6-37" style="verticalAlign=bottom;edgeStyle=elbowEdgeStyle;elbow=vertical;curved=0;rounded=0;endArrow=block;fontSize=14;" target="j7ZJ0DfRaMBOnBrSPlp6-40" value="insert(key, comm)">
          <mxGeometry relative="1" as="geometry">
            <Array as="points">
              <mxPoint x="1564" y="4051" />
            </Array>
          </mxGeometry>
        </mxCell>
        <mxCell id="j7ZJ0DfRaMBOnBrSPlp6-81" parent="j7ZJ0DfRaMBOnBrSPlp6-80" style="ellipse;aspect=fixed;fillColor=#000000;align=center;fontColor=#FFFFFF;fontSize=14;" value="13" vertex="1">
          <mxGeometry height="14" relative="1" width="14" as="geometry">
            <mxPoint x="-170.5" y="-7" as="offset" />
          </mxGeometry>
        </mxCell>
        <mxCell id="j7ZJ0DfRaMBOnBrSPlp6-82" edge="1" parent="1" source="j7ZJ0DfRaMBOnBrSPlp6-37" style="curved=1;dashed=1;dashPattern=2 3;endArrow=block;rounded=0;fontSize=14;" target="j7ZJ0DfRaMBOnBrSPlp6-37" value="return comm">
          <mxGeometry relative="1" as="geometry">
            <Array as="points">
              <mxPoint x="1444" y="4107" />
              <mxPoint x="1444" y="4137" />
            </Array>
          </mxGeometry>
        </mxCell>
        <mxCell id="j7ZJ0DfRaMBOnBrSPlp6-83" parent="j7ZJ0DfRaMBOnBrSPlp6-82" style="ellipse;aspect=fixed;fillColor=#000000;align=center;fontColor=#FFFFFF;fontSize=14;" value="14" vertex="1">
          <mxGeometry height="14" relative="1" width="14" as="geometry">
            <mxPoint x="-57" y="-22" as="offset" />
          </mxGeometry>
        </mxCell>
        <mxCell id="j7ZJ0DfRaMBOnBrSPlp6-84" edge="1" parent="1" source="j7ZJ0DfRaMBOnBrSPlp6-37" style="curved=1;endArrow=block;rounded=0;fontSize=14;" target="j7ZJ0DfRaMBOnBrSPlp6-37" value="pointToPoint(tensors, comm, ...)&#xa;模板函数封装通用逻辑">
          <mxGeometry relative="1" as="geometry">
            <Array as="points">
              <mxPoint x="1439" y="4305" />
              <mxPoint x="1439" y="4335" />
            </Array>
          </mxGeometry>
        </mxCell>
        <mxCell id="j7ZJ0DfRaMBOnBrSPlp6-85" parent="j7ZJ0DfRaMBOnBrSPlp6-84" style="ellipse;aspect=fixed;fillColor=#000000;align=center;fontColor=#FFFFFF;fontSize=14;" value="15" vertex="1">
          <mxGeometry height="14" relative="1" width="14" as="geometry">
            <mxPoint x="-57" y="-22" as="offset" />
          </mxGeometry>
        </mxCell>
        <mxCell id="j7ZJ0DfRaMBOnBrSPlp6-86" edge="1" parent="1" source="j7ZJ0DfRaMBOnBrSPlp6-37" style="curved=1;endArrow=block;rounded=0;fontSize=14;" target="j7ZJ0DfRaMBOnBrSPlp6-37" value="syncStreams(devices, events)">
          <mxGeometry relative="1" as="geometry">
            <Array as="points">
              <mxPoint x="1444" y="4458" />
              <mxPoint x="1444" y="4488" />
            </Array>
          </mxGeometry>
        </mxCell>
        <mxCell id="j7ZJ0DfRaMBOnBrSPlp6-87" parent="j7ZJ0DfRaMBOnBrSPlp6-86" style="ellipse;aspect=fixed;fillColor=#000000;align=center;fontColor=#FFFFFF;fontSize=14;" value="16" vertex="1">
          <mxGeometry height="14" relative="1" width="14" as="geometry">
            <mxPoint x="-57" y="-22" as="offset" />
          </mxGeometry>
        </mxCell>
        <mxCell id="j7ZJ0DfRaMBOnBrSPlp6-88" edge="1" parent="1" source="j7ZJ0DfRaMBOnBrSPlp6-37" style="verticalAlign=bottom;edgeStyle=elbowEdgeStyle;elbow=vertical;curved=0;rounded=0;endArrow=block;fontSize=14;" target="j7ZJ0DfRaMBOnBrSPlp6-44" value="cnclSend(data_ptr, size, dst, stream)&#xa;非阻塞提交">
          <mxGeometry relative="1" as="geometry">
            <Array as="points">
              <mxPoint x="1781" y="4567" />
            </Array>
          </mxGeometry>
        </mxCell>
        <mxCell id="j7ZJ0DfRaMBOnBrSPlp6-89" parent="j7ZJ0DfRaMBOnBrSPlp6-88" style="ellipse;aspect=fixed;fillColor=#000000;align=center;fontColor=#FFFFFF;fontSize=14;" value="17" vertex="1">
          <mxGeometry height="14" relative="1" width="14" as="geometry">
            <mxPoint x="-387.75" y="-7" as="offset" />
          </mxGeometry>
        </mxCell>
        <mxCell id="j7ZJ0DfRaMBOnBrSPlp6-90" edge="1" parent="1" source="j7ZJ0DfRaMBOnBrSPlp6-42" style="verticalAlign=bottom;edgeStyle=elbowEdgeStyle;elbow=vertical;curved=0;rounded=0;dashed=1;dashPattern=2 3;endArrow=block;fontSize=14;" target="j7ZJ0DfRaMBOnBrSPlp6-37" value="void (queued)">
          <mxGeometry relative="1" as="geometry">
            <Array as="points">
              <mxPoint x="1782" y="4615" />
            </Array>
          </mxGeometry>
        </mxCell>
        <mxCell id="j7ZJ0DfRaMBOnBrSPlp6-91" parent="j7ZJ0DfRaMBOnBrSPlp6-90" style="ellipse;aspect=fixed;fillColor=#000000;align=center;fontColor=#FFFFFF;fontSize=14;" value="18" vertex="1">
          <mxGeometry height="14" relative="1" width="14" as="geometry">
            <mxPoint x="371.75" y="-7" as="offset" />
          </mxGeometry>
        </mxCell>
        <mxCell id="j7ZJ0DfRaMBOnBrSPlp6-92" edge="1" parent="1" source="j7ZJ0DfRaMBOnBrSPlp6-37" style="verticalAlign=bottom;edgeStyle=elbowEdgeStyle;elbow=vertical;curved=0;rounded=0;endArrow=block;fontSize=14;" target="j7ZJ0DfRaMBOnBrSPlp6-46" value="new MyWork(tensors, ...)&#xa;记录Event用于后续wait()">
          <mxGeometry relative="1" as="geometry">
            <Array as="points">
              <mxPoint x="1926" y="4743" />
            </Array>
          </mxGeometry>
        </mxCell>
        <mxCell id="j7ZJ0DfRaMBOnBrSPlp6-93" parent="j7ZJ0DfRaMBOnBrSPlp6-92" style="ellipse;aspect=fixed;fillColor=#000000;align=center;fontColor=#FFFFFF;fontSize=14;" value="19" vertex="1">
          <mxGeometry height="14" relative="1" width="14" as="geometry">
            <mxPoint x="-532.25" y="-7" as="offset" />
          </mxGeometry>
        </mxCell>
        <mxCell id="j7ZJ0DfRaMBOnBrSPlp6-94" edge="1" parent="1" source="j7ZJ0DfRaMBOnBrSPlp6-45" style="verticalAlign=bottom;edgeStyle=elbowEdgeStyle;elbow=vertical;curved=0;rounded=0;dashed=1;dashPattern=2 3;endArrow=block;fontSize=14;" target="j7ZJ0DfRaMBOnBrSPlp6-37" value="work_ptr">
          <mxGeometry relative="1" as="geometry">
            <Array as="points">
              <mxPoint x="1927" y="4791" />
            </Array>
          </mxGeometry>
        </mxCell>
        <mxCell id="j7ZJ0DfRaMBOnBrSPlp6-95" parent="j7ZJ0DfRaMBOnBrSPlp6-94" style="ellipse;aspect=fixed;fillColor=#000000;align=center;fontColor=#FFFFFF;fontSize=14;" value="20" vertex="1">
          <mxGeometry height="14" relative="1" width="14" as="geometry">
            <mxPoint x="516.25" y="-7" as="offset" />
          </mxGeometry>
        </mxCell>
        <mxCell id="j7ZJ0DfRaMBOnBrSPlp6-96" edge="1" parent="1" source="j7ZJ0DfRaMBOnBrSPlp6-37" style="verticalAlign=bottom;edgeStyle=elbowEdgeStyle;elbow=vertical;curved=0;rounded=0;dashed=1;dashPattern=2 3;endArrow=block;fontSize=14;" target="j7ZJ0DfRaMBOnBrSPlp6-35" value="return work_ptr">
          <mxGeometry relative="1" as="geometry">
            <Array as="points">
              <mxPoint x="1238" y="4847" />
            </Array>
          </mxGeometry>
        </mxCell>
        <mxCell id="j7ZJ0DfRaMBOnBrSPlp6-97" parent="j7ZJ0DfRaMBOnBrSPlp6-96" style="ellipse;aspect=fixed;fillColor=#000000;align=center;fontColor=#FFFFFF;fontSize=14;" value="21" vertex="1">
          <mxGeometry height="14" relative="1" width="14" as="geometry">
            <mxPoint x="146.5" y="-7" as="offset" />
          </mxGeometry>
        </mxCell>
        <mxCell id="j7ZJ0DfRaMBOnBrSPlp6-98" edge="1" parent="1" source="j7ZJ0DfRaMBOnBrSPlp6-35" style="verticalAlign=bottom;edgeStyle=elbowEdgeStyle;elbow=vertical;curved=0;rounded=0;endArrow=block;fontSize=14;" target="j7ZJ0DfRaMBOnBrSPlp6-47" value="work.wait()">
          <mxGeometry relative="1" as="geometry">
            <Array as="points">
              <mxPoint x="1766" y="4952" />
            </Array>
          </mxGeometry>
        </mxCell>
        <mxCell id="j7ZJ0DfRaMBOnBrSPlp6-99" parent="j7ZJ0DfRaMBOnBrSPlp6-98" style="ellipse;aspect=fixed;fillColor=#000000;align=center;fontColor=#FFFFFF;fontSize=14;" value="22" vertex="1">
          <mxGeometry height="14" relative="1" width="14" as="geometry">
            <mxPoint x="-691.75" y="-7" as="offset" />
          </mxGeometry>
        </mxCell>
        <mxCell id="j7ZJ0DfRaMBOnBrSPlp6-100" edge="1" parent="1" source="j7ZJ0DfRaMBOnBrSPlp6-47" style="verticalAlign=bottom;edgeStyle=elbowEdgeStyle;elbow=vertical;curved=0;rounded=0;endArrow=block;fontSize=14;" target="j7ZJ0DfRaMBOnBrSPlp6-42" value="check_status() / event_sync()">
          <mxGeometry relative="1" as="geometry">
            <Array as="points">
              <mxPoint x="2307" y="5008" />
            </Array>
          </mxGeometry>
        </mxCell>
        <mxCell id="j7ZJ0DfRaMBOnBrSPlp6-101" parent="j7ZJ0DfRaMBOnBrSPlp6-100" style="ellipse;aspect=fixed;fillColor=#000000;align=center;fontColor=#FFFFFF;fontSize=14;" value="23" vertex="1">
          <mxGeometry height="14" relative="1" width="14" as="geometry">
            <mxPoint x="136" y="-7" as="offset" />
          </mxGeometry>
        </mxCell>
        <mxCell id="j7ZJ0DfRaMBOnBrSPlp6-102" edge="1" parent="1" source="j7ZJ0DfRaMBOnBrSPlp6-47" style="verticalAlign=bottom;edgeStyle=elbowEdgeStyle;elbow=vertical;curved=0;rounded=0;dashed=1;dashPattern=2 3;endArrow=block;fontSize=14;" target="j7ZJ0DfRaMBOnBrSPlp6-35" value="true">
          <mxGeometry relative="1" as="geometry">
            <Array as="points">
              <mxPoint x="1767" y="5056" />
            </Array>
          </mxGeometry>
        </mxCell>
        <mxCell id="j7ZJ0DfRaMBOnBrSPlp6-103" parent="j7ZJ0DfRaMBOnBrSPlp6-102" style="ellipse;aspect=fixed;fillColor=#000000;align=center;fontColor=#FFFFFF;fontSize=14;" value="24" vertex="1">
          <mxGeometry height="14" relative="1" width="14" as="geometry">
            <mxPoint x="675.75" y="-7" as="offset" />
          </mxGeometry>
        </mxCell>
        <mxCell id="j7ZJ0DfRaMBOnBrSPlp6-104" parent="1" style="fillColor=#ffff88;strokeColor=#9E916F;fontSize=14;" value="[Step 1] Python 调用 dist.send(tensor, dst=1)&#xa;假设 Tensor 在 Die 1 上" vertex="1">
          <mxGeometry height="67" width="360" x="1049" y="2754" as="geometry" />
        </mxCell>
        <mxCell id="j7ZJ0DfRaMBOnBrSPlp6-105" parent="1" style="fillColor=#ffff88;strokeColor=#9E916F;fontSize=14;" value="[Step 2] 核心难点：建立连接 (getCNCLComm)" vertex="1">
          <mxGeometry height="49" width="820" x="1359" y="3083" as="geometry" />
        </mxCell>
        <mxCell id="j7ZJ0DfRaMBOnBrSPlp6-106" parent="1" style="fillColor=#ffff88;strokeColor=#9E916F;fontSize=14;" value="这里的逻辑根据 rank 区分" vertex="1">
          <mxGeometry height="49" width="211" x="1409" y="3438" as="geometry" />
        </mxCell>
        <mxCell id="j7ZJ0DfRaMBOnBrSPlp6-107" parent="1" style="fillColor=#ffff88;strokeColor=#9E916F;fontSize=14;" value="[Step 3] 提交任务给硬件" vertex="1">
          <mxGeometry height="49" width="820" x="1359" y="4197" as="geometry" />
        </mxCell>
        <mxCell id="j7ZJ0DfRaMBOnBrSPlp6-108" parent="1" style="fillColor=#ffff88;strokeColor=#9E916F;fontSize=14;" value="确保计算流(Compute Stream)的数据&#xa;已经准备好，可以被通信流读取" vertex="1">
          <mxGeometry height="67" width="285" x="1409" y="4355" as="geometry" />
        </mxCell>
        <mxCell id="j7ZJ0DfRaMBOnBrSPlp6-109" parent="1" style="fillColor=#ffff88;strokeColor=#9E916F;fontSize=14;" value="[Step 4] 创建并返回 Work 对象" vertex="1">
          <mxGeometry height="49" width="1109" x="1359" y="4635" as="geometry" />
        </mxCell>
        <mxCell id="j7ZJ0DfRaMBOnBrSPlp6-110" parent="1" style="fillColor=#ffff88;strokeColor=#9E916F;fontSize=14;" value="[Step 5] 用户等待完成" vertex="1">
          <mxGeometry height="49" width="1419" x="1049" y="4867" as="geometry" />
        </mxCell>
      </root>
    </mxGraphModel>
  </diagram>
</mxfile>
